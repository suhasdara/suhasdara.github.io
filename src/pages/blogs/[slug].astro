---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import CodeBlock from '../../components/CodeBlock.astro';
import Comments from '../../components/Comments.astro';

export async function getStaticPaths() {
  const blogs = await getCollection('blogs');
  return blogs.map((blog) => ({
    params: { slug: blog.data.slug || blog.slug },
    props: { blog },
  }));
}

const { blog } = Astro.props;
const { Content } = await blog.render();

import { formatBlogDate as formatDate } from '../../utils/dateUtils';
---

<BaseLayout title={`${blog.data.title} - Suhas Dara`}>
  <article class="max-w-4xl mx-auto">
    <div class="mb-8">
      <a href="/blogs" class="text-blue-400 hover:text-blue-300 mb-4 inline-block">
        ‚Üê Back to Blogs
      </a>
      <h1 class="text-4xl font-bold mb-4">{blog.data.title}</h1>
      
      <div class="flex items-center gap-4 mb-6">
        <time class="text-gray-400">{formatDate(blog.data.date.toISOString().split('T')[0])}</time>
        <div class="flex flex-wrap gap-2">
          {blog.data.tags.map((tag) => (
            <span class="bg-purple-600 text-white px-2 py-1 rounded text-sm">#{tag}</span>
          ))}
        </div>
      </div>
    </div>

    <div class="prose prose-invert prose-blue prose-lg max-w-none">
      <Content />
    </div>

    <Comments />
  </article>
  
  <CodeBlock />
</BaseLayout>

